#Circle-CI

#machine:
#  php:
#    version: 7.0.17

checkout:
 post:
   - git clone https://github.com/ClearSkyTeam/CI-Test
   - git submodule sync --recursive
   - git submodule update --recursive --init

dependencies:
  pre:
    - echo $PHP_ENVIROMENT
    - rm /opt/circleci/php/$(phpenv global)/etc/conf.d/xdebug.ini
    - wget -O PHP7.tar.gz https://dl.bintray.com/pocketmine/PocketMine/PHP_7.0.6_x86-64_Linux.tar.gz --no-check-certificate
    - tar -xf PHP7.tar.gz
  override:
    - finalCMD=$(printf "s/CuttingEdge/$CIRCLE_BUILD_NUM/g"); printf ${finalCMD}; sed -i -e ${finalCMD} src/pocketmine/PocketMine.php;
    - mkdir plugins && wget -O plugins/DevTools.phar https://github.com/ClearSkyTeam/DevTools/releases/download/v1.12.0/DevTools_v1.12.0.phar

test:
  override:
    - $PHP_ENVIROMENT CI-Test/Travis.sh
    - cp -rv ./plugins/DevTools/ $CIRCLE_ARTIFACTS
